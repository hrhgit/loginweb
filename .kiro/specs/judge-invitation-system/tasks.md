# 邀请评委功能实施计划

## 实施概述

本实施计划将邀请评委功能分解为一系列增量开发任务，每个任务都建立在前一个任务的基础上。重点关注核心功能的实现，然后逐步添加用户界面和高级功能。

## 任务列表

- [x] 1. 数据库结构和权限设置





  - 创建 event_judges 表结构
  - 设置 RLS 安全策略和索引
  - 更新数据库迁移脚本
  - _需求: 5.1, 5.4, 5.5_

- [ ]* 1.1 为数据库结构编写属性测试
  - **属性 8: 级联删除一致性**
  - **验证需求: 5.4, 5.5**

- [x] 2. 核心数据模型和类型定义





  - 在 models.ts 中添加 EventJudge 相关类型
  - 定义 JudgePermission 和相关接口
  - 添加错误类型定义
  - _需求: 5.1_

- [ ]* 2.1 为数据模型编写属性测试
  - **属性 6: 权限验证一致性**
  - **验证需求: 5.1**


- [x] 3. 状态管理扩展




- [x] 3.1 在 appStore.ts 中添加评委相关状态


  - 添加 judgesByEventId, judgePermissionsByEventId 等状态
  - 实现基础的状态管理结构
  - _需求: 2.1, 3.1_

- [x] 3.2 实现评委权限检查函数


  - 实现 checkJudgePermission 函数
  - 添加权限验证逻辑
  - _需求: 5.1, 3.4_

- [ ]* 3.3 为权限检查编写属性测试
  - **属性 6: 权限验证一致性**
  - **验证需求: 5.1**

- [x] 3.4 实现评委数据加载函数


  - 实现 loadEventJudges 函数
  - 添加错误处理和缓存逻辑
  - _需求: 4.1, 4.2_

- [ ]* 3.5 为数据加载编写属性测试
  - **属性 5: 数据访问权限控制**
  - **验证需求: 3.3, 5.2**

- [x] 4. 评委邀请核心功能







- [x] 4.1 实现用户搜索功能


  - 实现 searchUsersForJudge 函数
  - 添加搜索过滤逻辑（排除已有评委）
  - _需求: 1.2_

- [ ]* 4.2 为用户搜索编写属性测试
  - **属性 1: 用户搜索一致性**
  - **验证需求: 1.2**

- [x] 4.3 实现评委邀请功能

  - 实现 inviteJudge 函数
  - 添加重复邀请检查
  - 集成通知系统
  - _需求: 1.3, 1.4, 1.5, 2.1, 2.2_

- [ ]* 4.4 为评委邀请编写属性测试
  - **属性 2: 邀请操作原子性**
  - **验证需求: 1.3, 1.5, 2.1**

- [ ]* 4.5 为重复邀请防护编写属性测试
  - **属性 10: 重复邀请防护**
  - **验证需求: 1.4**

- [x] 4.6 实现评委移除功能

  - 实现 removeJudge 函数
  - 添加权限撤销逻辑
  - 集成通知系统
  - _需求: 4.3, 4.4, 4.5_

- [ ]* 4.7 为评委移除编写属性测试
  - **属性 7: 权限撤销原子性**
  - **验证需求: 4.3, 4.5**


- [x] 5. 检查点 - 确保所有核心功能测试通过




  - 确保所有测试通过，如有问题请询问用户


- [x] 6. 评委邀请用户界面




- [x] 6.1 创建用户搜索组件


  - 创建 UserSearchModal.vue 组件
  - 实现搜索输入和结果显示
  - 添加用户选择和确认功能
  - _需求: 1.1, 1.2, 1.3_

- [ ]* 6.2 为用户搜索组件编写单元测试
  - 测试搜索输入处理
  - 测试结果显示和用户选择
  - _需求: 1.1, 1.2, 1.3_

- [x] 6.3 创建评委邀请按钮


  - 在活动卡片上添加"邀请评委"按钮
  - 添加权限检查（仅活动创建者可见）
  - 连接到用户搜索模态框
  - _需求: 1.1_

- [x] 6.4 集成邀请流程


  - 连接前端组件与后端 API
  - 添加成功/错误状态处理
  - 实现实时状态更新
  - _需求: 1.3, 1.4, 1.5_

- [ ]* 6.5 为邀请流程编写属性测试
  - **属性 4: 通知系统一致性**
  - **验证需求: 2.2, 2.5, 4.4**

- [x] 7. 评委管理界面







- [x] 7.1 创建评委管理面板组件


  - 创建 JudgeManagementPanel.vue 组件
  - 实现评委列表显示
  - 添加移除评委功能
  - _需求: 4.1, 4.2, 4.3_

- [ ]* 7.2 为评委管理面板编写单元测试
  - 测试评委列表显示
  - 测试移除评委操作
  - _需求: 4.1, 4.2, 4.3_

- [x] 7.3 集成评委管理到活动后台


  - 在活动管理后台添加评委管理标签页
  - 连接评委管理面板组件
  - 添加权限检查
  - _需求: 4.1_


- [x] 8. 评委工作台界面




- [x] 8.1 创建评委工作台组件




  - 创建 JudgeWorkspace.vue 组件
  - 实现作品列表显示（仅作品信息）
  - 添加批量下载功能
  - _需求: 3.2, 3.3, 3.5_

- [ ]* 8.2 为评委工作台编写属性测试
  - **属性 5: 数据访问权限控制**
  - **验证需求: 3.3, 5.2**


- [x] 8.3 创建评委入口按钮




  - 在活动详情页添加"评委入口"按钮
  - 添加权限检查（仅评委可见）
  - 连接到评委工作台
  - _需求: 3.1_

- [ ]* 8.4 为评委入口编写属性测试
  - **属性 3: 权限状态一致性**
  - **验证需求: 2.4, 3.1**

- [x] 8.5 实现评委路由和页面




  - 添加评委工作台路由
  - 创建独立的评委页面
  - 添加路由权限守卫
  - _需求: 3.2, 3.4_

- [ ]* 8.6 为路由权限编写属性测试
  - **属性 6: 权限验证一致性**
  - **验证需求: 5.1**

- [x] 9. 通知系统集成





- [x] 9.1 实现评委权限通知


  - 添加评委权限获得通知
  - 添加评委权限撤销通知
  - 集成到现有通知系统
  - _需求: 2.2, 2.5, 4.4_

- [ ]* 9.2 为通知系统编写属性测试
  - **属性 4: 通知系统一致性**
  - **验证需求: 2.2, 2.5, 4.4**

- [x] 9.3 实现通知点击跳转


  - 添加评委通知的点击处理
  - 实现跳转到评委工作台
  - _需求: 2.3_

- [x] 10. 权限持久性和状态管理





- [x] 10.1 实现权限持久性检查


  - 添加活动状态变更时的权限保持逻辑
  - 实现权限有效性验证
  - _需求: 5.3_

- [ ]* 10.2 为权限持久性编写属性测试
  - **属性 9: 权限持久性**
  - **验证需求: 5.3**

- [x] 10.3 优化状态管理和缓存


  - 优化评委数据的缓存策略
  - 添加实时状态同步
  - 处理并发访问问题
  - _需求: 2.1, 3.1_

- [x] 11. 最终检查点 - 确保所有测试通过




  - 确保所有测试通过，如有问题请询问用户


- [x] 12. 用户体验优化




- [x] 12.1 添加加载状态和错误处理


  - 为所有异步操作添加加载指示器
  - 实现友好的错误消息显示
  - 添加重试机制

- [ ]* 12.2 为错误处理编写单元测试
  - 测试各种错误场景
  - 测试错误消息显示
  - 测试重试机制

- [x] 12.3 优化界面响应性和交互


  - 优化移动端显示
  - 添加键盘快捷键支持
  - 改进无障碍访问性

- [ ]* 12.4 进行跨浏览器兼容性测试
  - 测试主流浏览器兼容性
  - 测试文件下载功能
  - 测试响应式设计